import pandas as pd
import re

# Función para limpiar y validar correos
def limpiar_correos(df, columna_correo):
    # Expresión regular para validar correos electrónicos
    regex = r'^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$'
    
    # Filtrar filas que tienen correos válidos en la columna especificada
    df_limpio = df[df[columna_correo].apply(lambda x: bool(re.match(regex, str(x))))]
    
    return df_limpio

# Leer la lista de correos desde un archivo Excel
def leer_excel(archivo_excel):
    # Cargar el archivo Excel
    df = pd.read_excel(archivo_excel)
    return df

# Guardar la lista de correos limpios y la información adicional en un nuevo archivo Excel
def guardar_correos_limpios(df_limpios, nombre_salida):
    df_limpios.to_excel(nombre_salida, index=False)

# Configurar los nombres de los archivos
archivo_entrada = "correos.xls"  # Nombre de tu archivo Excel de entrada
archivo_salida = "limpios.xls"   # Nombre del archivo donde guardar los correos limpios
columna_correo = "Correo"        # Nombre de la columna que contiene los correos

# Leer el archivo Excel original
df = leer_excel(archivo_entrada)

# Limpiar los correos inválidos
df_limpio = limpiar_correos(df, columna_correo)

# Guardar los correos válidos junto con la información restante en un nuevo archivo
guardar_correos_limpios(df_limpio, archivo_salida)

print(f"Proceso completado. Correos válidos guardados en '{archivo_salida}'.")
